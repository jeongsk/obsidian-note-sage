# Note Sage

[한국어](README.md) | [English](README_EN.md) | [简体中文](README_ZH.md) | [日本語](README_JA.md)

https://github.com/user-attachments/assets/3b251604-cf52-4f38-8c9d-fba67e280b64

ObsidianにAIエージェントを直接統合するプラグインです。Claude Code CLIをObsidianとシームレスに統合し、ワークスペースを離れることなくAIとチャット、ファイル編集、ナレッジベースの管理ができます。

## なぜこのプラグインを作ったのか？

AIを使用する際にワークフローが中断されたり、vaultのコンテキストが失われたりすべきではありません。

このプラグインはClaudeがObsidian環境を認識できるようにし、ターミナルに切り替えることなくワークスペース内ですべての作業を完了できます。また、コンテキストをより効果的に管理するための機能も提供します。

## 主な機能

- **直接AI統合**：ObsidianのインターフェースでClaude Codeと直接チャット
- **ファイル優先アプローチ**：AIエージェントがvault内のファイルを読み取り、編集、作成可能
- **コンテキスト認識**：関連するvaultコンテキストを自動的に会話に含める
- **リアルタイムコラボレーション**：ObsidianインターフェースでAIの編集をリアルタイムで確認
- **クイックアクション**：事前定義されたプロンプトで一般的なタスクを素早く実行（要約、改善、分析、翻訳）
- **多言語UI**：英語と韓国語のインターフェースをサポート
- **セッション管理**：会話の連続性を維持し、会話を保存

## インストール

### 前提条件

- **Anthropicアカウント** - Claude APIアクセスに必要（[console.anthropic.com](https://console.anthropic.com)）
- **Node.js** - プラグイン実行に必要
- **Claude Code CLI** - [Anthropic's Claude Code](https://www.anthropic.com/claude-code)から取得

### セットアップ

*近日中にObsidianコミュニティプラグインストアに登録予定*

1. **CLIアクセスの確認**：ターミナルで`claude`を実行できることを確認
2. **ダウンロード**：[リリースページ](../../releases)から最新版（`obsidian-note-sage.zip`）を取得
3. **インストール**：解凍して`[vault パス]/.obsidian/plugins/obsidian-note-sage`にフォルダを配置
4. **有効化**：Obsidianのコミュニティプラグイン設定でプラグインを有効化
5. **チャット開始**：ワークスペース右サイドバーのNote Sageパネルを使用

> [!WARNING]
> **プレビュー版のご注意**
>
> このプラグインは現在開発中であり、vault内のファイルを変更します。完全な機能のために昇格された権限（`--permission-mode bypassPermissions`および`dangerously-skip-permissions`）を使用しています。
>
> **推奨事項**：使用前にvaultをバックアップしてください。詳細な権限制御は将来のリリースで追加予定です。

## 使い方

### 基本的な使い方

1. 右サイドバーのNote Sageアイコンをクリック
2. チャット入力欄にメッセージを入力
3. Enterで送信（Shift+Enterで改行）
4. 「現在のページ」ボタンで現在のノートコンテキストの含める/除外を選択

### クイックアクション

チャット入力欄の上にあるクイックアクションボタンで一般的なタスクを素早く実行：

- **要約**：現在のドキュメントを簡潔に要約
- **改善**：文章スタイルを改善しエラーを修正
- **分析**：ドキュメントを分析しインサイトを提供
- **翻訳**：韓国語と英語の間で翻訳

設定で各ボタンのプロンプトをカスタマイズできます。

## 設定

### 基本設定

| 設定 | 説明 |
|------|------|
| モデル | Claudeモデルを選択（opus-4-5、sonnet-4-5、haiku-4-5）|
| 言語 | インターフェース言語（自動/英語/韓国語）|

### ファイルコンテキスト

| 設定 | 説明 |
|------|------|
| ファイル内容を含める | コンテキストに現在のファイル内容を含める |
| 選択テキストを優先 | テキストが選択されている場合、ファイル全体ではなく選択部分のみを含める |
| 最大内容長 | ファイルから含める最大文字数（トークン節約用）|

### クイックアクション

設定で各クイックアクションボタンのプロンプトをカスタマイズ。デフォルトを使用する場合は空欄のままにしてください。

### 詳細設定

| 設定 | 説明 |
|------|------|
| APIキー | Anthropic APIキー（オプション）|
| Claude CLIパス | claude実行ファイルのパス（空欄の場合は自動検出）|
| カスタムシステムプロンプト | Claudeへのカスタム指示 |
| デバッグモード | トラブルシューティング用のデバッグログを有効化 |

## トラブルシューティング

### CLIの問題

**Node.jsまたはClaude CLIが見つからない場合**

1. **インストールの確認**：ターミナルで`node --version`と`claude --version`を実行
2. **手動設定**：自動検出に失敗した場合、**設定 > コミュニティプラグイン > Note Sage**でパスを手動設定

**実行ファイルのパスを探す：**
```bash
# Node.jsの場所
which node

# Claude CLIの場所
echo "$(sed -n 's/^exec "\([^"]*\)".*/\1/p' $(which claude))"
```

**Windowsユーザー**：ClaudeはWSLにインストールする必要があります。Windowsネイティブサポートはまだテスト中です。

### デバッグモード

**詳細ログを有効にする：**
1. **設定 > コミュニティプラグイン > Note Sage**に移動
2. 「デバッグモード」を有効化
3. 開発者コンソールを開く：`Cmd+Opt+I`（Mac）または`Ctrl+Shift+I`（Windows/Linux）

## ロードマップ

### コア機能
- [ ] **インタラクションモード** - 書き込みモード、計画モード、カスタムワークフロー
- [ ] **権限制御** - 詳細なファイルアクセスと編集権限
- [ ] **クロスプラットフォームサポート** - Windows/WSL互換性の強化

### Obsidian統合
- [ ] **コンテキストメニュー統合** - ファイルエクスプローラーから「AIコンテキストに追加」
- [ ] **ファイルリンク** - モデルが読み取り/編集したファイルを開く
- [ ] **拡張コピー/ペースト** - スマートコンテキストコピー/ペースト

## プライバシーとデータ処理

### リモートサービス

このプラグインは**Anthropic Claude API**を使用してリクエストを処理します。メッセージ送信時：
- プロンプトテキストがAnthropicサーバーに送信されます
- 「現在のページ」コンテキストが有効な場合、ファイル内容も送信されます
- データは[Anthropicプライバシーポリシー](https://www.anthropic.com/privacy)に従って処理されます

### アカウント要件

- **Anthropic APIキー**：APIアクセスに必要
  - [console.anthropic.com](https://console.anthropic.com)で取得
  - vaultのプラグインデータにローカル保存（暗号化されません）

### ファイルシステムアクセス

このプラグインはObsidian vault外部の場所にアクセスします：
- **Claude CLI検出**：Claude実行ファイルを見つけるためにシステムパスを検索
  - macOS/Linux：`~/.local/bin/`、`/usr/local/bin/`、`/opt/homebrew/bin/`
  - Windows：`%USERPROFILE%\AppData\`、`C:\Program Files\`
- **エージェント権限**：昇格された権限（`bypassPermissions`）を使用してAIがvault内のファイルを読み取り/編集可能

### ローカルデータストレージ

- チャットメッセージはメモリにのみ保存（再起動時にクリア）
- 設定は`.obsidian/plugins/obsidian-note-sage/data.json`に保存
- 会話はmarkdownファイルとしてvaultに手動保存可能

## ライセンス

MIT License
